<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InventarioPro - Sistema Profesional de Inventario</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        /* Estilos del Login */
        .login-container {
            min-height: 100vh;
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 16px;
            padding: 40px;
            max-width: 400px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: #1976d2;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .logo h1 {
            color: #1976d2;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .logo p {
            color: #666;
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5f2;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #1976d2;
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: #1976d2;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
            margin-bottom: 20px;
        }

        .btn:hover {
            background: #1565c0;
        }

        .demo-users {
            border-top: 1px solid #e0e0e0;
            padding-top: 20px;
        }

        .demo-users h3 {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 15px;
            text-align: center;
        }

        .demo-user {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .demo-user:hover {
            background: #f8f9ff;
            border-color: #1976d2;
        }

        .demo-user-info h4 {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .demo-user-info p {
            font-size: 0.8rem;
            color: #666;
        }

        .role-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .role-admin { background: #ffebee; color: #c62828; }
        .role-manager { background: #fff8e1; color: #f57c00; }
        .role-employee { background: #e8f5e8; color: #2e7d32; }

        /* Estilos del Dashboard */
        .app-container {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 240px;
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            transition: width 0.3s ease;
        }

        .sidebar.collapsed {
            width: 60px;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            background: #f8f9fa;
        }

        .sidebar-brand {
            color: #1976d2;
            font-size: 1.2rem;
            font-weight: 700;
        }

        .sidebar-nav {
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #666;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-item:hover,
        .nav-item.active {
            background: #1976d2;
            color: white;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .navbar {
            height: 60px;
            background: white;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .navbar-left {
            display: flex;
            align-items: center;
        }

        .menu-toggle {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            margin-right: 15px;
            color: #666;
        }

        .navbar-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1976d2;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #1976d2;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .user-details h4 {
            font-size: 0.9rem;
            font-weight: 600;
        }

        .user-details p {
            font-size: 0.8rem;
            color: #666;
        }

        .logout-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .page-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 600;
            color: #333;
        }

        /* Dashboard espec√≠fico */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .stat-info h3 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-info p {
            color: #666;
            font-size: 0.9rem;
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .stat-products { background: #1976d2; }
        .stat-value { background: #2e7d32; }
        .stat-low { background: #f57c00; }
        .stat-users { background: #7b1fa2; }

        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .chart-card h3 {
            margin-bottom: 20px;
            color: #333;
        }

        .products-table {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .table-header {
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .add-btn {
            background: #1976d2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        tr:hover {
            background: #f8f9ff;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-active { background: #e8f5e8; color: #2e7d32; }
        .status-low { background: #fff3e0; color: #f57c00; }
        .status-out { background: #ffebee; color: #c62828; }

        .action-btn {
            background: none;
            border: none;
            padding: 6px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 5px;
            color: #666;
        }

        .action-btn:hover {
            background: #f0f0f0;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-secondary {
            background: #666;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 60px;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            table {
                font-size: 0.9rem;
            }
        }

        /* Animaciones */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Datos simulados
        const DEMO_USERS = [
            { id: 1, email: 'admin@inventario.com', password: 'admin123', name: 'Mar√≠a Gonz√°lez', role: 'admin' },
            { id: 2, email: 'gerente@inventario.com', password: 'gerente123', name: 'Carlos Rodr√≠guez', role: 'manager' },
            { id: 3, email: 'empleado@inventario.com', password: 'empleado123', name: 'Ana Mart√≠nez', role: 'employee' }
        ];

        const INITIAL_PRODUCTS = [
            { id: 1, name: 'iPhone 15', sku: 'IPH-15-001', category: 'Tecnolog√≠a', quantity: 15, minStock: 5, price: 899990, status: 'active' },
            { id: 2, name: 'Laptop Dell XPS', sku: 'DEL-XPS-002', category: 'Tecnolog√≠a', quantity: 3, minStock: 5, price: 1299990, status: 'active' },
            { id: 3, name: 'Auriculares Sony', sku: 'SON-AUR-003', category: 'Tecnolog√≠a', quantity: 25, minStock: 10, price: 199990, status: 'active' },
            { id: 4, name: 'Mesa de Oficina', sku: 'HOG-MES-004', category: 'Hogar', quantity: 8, minStock: 3, price: 149990, status: 'active' },
            { id: 5, name: 'Silla Ergon√≥mica', sku: 'HOG-SIL-005', category: 'Hogar', quantity: 12, minStock: 5, price: 89990, status: 'active' },
            { id: 6, name: 'Camiseta Nike', sku: 'NIK-CAM-006', category: 'Ropa', quantity: 0, minStock: 10, price: 29990, status: 'active' }
        ];

        // Componente principal
        function App() {
            const [user, setUser] = useState(null);
            const [currentPage, setCurrentPage] = useState('dashboard');
            const [sidebarCollapsed, setSidebarCollapsed] = useState(false);
            const [products, setProducts] = useState(() => {
                const saved = localStorage.getItem('inventario_pro_products');
                return saved ? JSON.parse(saved) : INITIAL_PRODUCTS;
            });
            const [showProductModal, setShowProductModal] = useState(false);
            const [editingProduct, setEditingProduct] = useState(null);

            useEffect(() => {
                localStorage.setItem('inventario_pro_products', JSON.stringify(products));
            }, [products]);

            const login = (email, password) => {
                const foundUser = DEMO_USERS.find(u => u.email === email && u.password === password);
                if (foundUser) {
                    setUser(foundUser);
                    return true;
                }
                return false;
            };

            const logout = () => {
                setUser(null);
                setCurrentPage('dashboard');
            };

            if (!user) {
                return <LoginPage onLogin={login} />;
            }

            return (
                <div className="app-container">
                    <Sidebar 
                        currentPage={currentPage} 
                        setCurrentPage={setCurrentPage}
                        collapsed={sidebarCollapsed}
                        user={user}
                    />
                    <div className="main-content">
                        <Navbar 
                            user={user} 
                            onLogout={logout}
                            onToggleSidebar={() => setSidebarCollapsed(!sidebarCollapsed)}
                        />
                        <div className="page-content">
                            {currentPage === 'dashboard' && <Dashboard products={products} />}
                            {currentPage === 'products' && (
                                <Products 
                                    products={products} 
                                    setProducts={setProducts}
                                    user={user}
                                />
                            )}
                            {currentPage === 'reports' && <Reports products={products} />}
                        </div>
                    </div>
                </div>
            );
        }

        // Componente de Login
        function LoginPage({ onLogin }) {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (onLogin(email, password)) {
                    setError('');
                } else {
                    setError('Credenciales inv√°lidas');
                }
            };

            const handleDemoLogin = (demoUser) => {
                setEmail(demoUser.email);
                setPassword(demoUser.password);
                onLogin(demoUser.email, demoUser.password);
            };

            return (
                <div className="login-container">
                    <div className="login-card fade-in">
                        <div className="logo">
                            <div className="logo-icon">üè¢</div>
                            <h1>InventarioPro</h1>
                            <p>Sistema Profesional de Inventario</p>
                        </div>

                        {error && (
                            <div style={{color: '#f44336', textAlign: 'center', marginBottom: '20px', padding: '10px', background: '#ffebee', borderRadius: '8px'}}>
                                {error}
                            </div>
                        )}

                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label>Correo Electr√≥nico</label>
                                <input
                                    type="email"
                                    value={email}
                                    onChange={(e) => setEmail(e.target.value)}
                                    placeholder="admin@inventario.com"
                                    required
                                />
                            </div>
                            <div className="form-group">
                                <label>Contrase√±a</label>
                                <input
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    placeholder="admin123"
                                    required
                                />
                            </div>
                            <button type="submit" className="btn">Iniciar Sesi√≥n</button>
                        </form>

                        <div className="demo-users">
                            <h3>üëÜ Haz clic para probar:</h3>
                            {DEMO_USERS.map(user => (
                                <div 
                                    key={user.id} 
                                    className="demo-user"
                                    onClick={() => handleDemoLogin(user)}
                                >
                                    <div className="demo-user-info">
                                        <h4>{user.name}</h4>
                                        <p>{user.email}</p>
                                    </div>
                                    <span className={`role-badge role-${user.role}`}>
                                        {user.role === 'admin' ? 'Administrador' : 
                                         user.role === 'manager' ? 'Gerente' : 'Empleado'}
                                    </span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // Componente Sidebar
        function Sidebar({ currentPage, setCurrentPage, collapsed, user }) {
            const menuItems = [
                { id: 'dashboard', name: 'Dashboard', icon: 'üìä', roles: [] },
                { id: 'products', name: 'Productos', icon: 'üì¶', roles: [] },
                { id: 'reports', name: 'Reportes', icon: 'üìà', roles: ['admin', 'manager'] }
            ];

            const hasAccess = (roles) => {
                return roles.length === 0 || roles.includes(user.role);
            };

            return (
                <div className={`sidebar ${collapsed ? 'collapsed' : ''}`}>
                    <div className="sidebar-header">
                        <div className="sidebar-brand">
                            {collapsed ? 'IP' : 'InventarioPro'}
                        </div>
                    </div>
                    <nav className="sidebar-nav">
                        {menuItems.filter(item => hasAccess(item.roles)).map(item => (
                            <div
                                key={item.id}
                                className={`nav-item ${currentPage === item.id ? 'active' : ''}`}
                                onClick={() => setCurrentPage(item.id)}
                            >
                                <span className="nav-icon">{item.icon}</span>
                                {!collapsed && <span>{item.name}</span>}
                            </div>
                        ))}
                    </nav>
                </div>
            );
        }

        // Componente Navbar
        function Navbar({ user, onLogout, onToggleSidebar }) {
            const getRoleName = (role) => {
                const roles = { admin: 'Administrador', manager: 'Gerente', employee: 'Empleado' };
                return roles[role] || 'Usuario';
            };

            return (
                <div className="navbar">
                    <div className="navbar-left">
                        <button className="menu-toggle" onClick={onToggleSidebar}>
                            ‚ò∞
                        </button>
                        <h1 className="navbar-title">Sistema de Inventario</h1>
                    </div>
                    <div className="navbar-right">
                        <div className="user-info">
                            <div className="user-details">
                                <h4>{user.name}</h4>
                                <p>{getRoleName(user.role)}</p>
                            </div>
                            <div className="user-avatar">
                                {user.name.charAt(0).toUpperCase()}
                            </div>
                        </div>
                        <button className="logout-btn" onClick={onLogout}>
                            Salir
                        </button>
                    </div>
                </div>
            );
        }

        // Componente Dashboard
        function Dashboard({ products }) {
            const chartRef = useRef(null);
            const pieChartRef = useRef(null);

            const stats = {
                totalProducts: products.length,
                totalValue: products.reduce((sum, p) => sum + (p.quantity * p.price), 0),
                lowStock: products.filter(p => p.quantity <= p.minStock).length,
                totalUsers: 3
            };

            const formatCurrency = (value) => {
                return new Intl.NumberFormat('es-CL', {
                    style: 'currency',
                    currency: 'CLP',
                    minimumFractionDigits: 0
                }).format(value);
            };

            useEffect(() => {
                // Gr√°fico de l√≠neas
                if (chartRef.current) {
                    const ctx = chartRef.current.getContext('2d');
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
                            datasets: [{
                                label: 'Ventas',
                                data: [12, 19, 15, 25, 22, 30],
                                borderColor: '#1976d2',
                                backgroundColor: 'rgba(25, 118, 210, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                y: { beginAtZero: true }
                            }
                        }
                    });
                }

                // Gr√°fico de dona
                if (pieChartRef.current) {
                    const ctx = pieChartRef.current.getContext('2d');
                    const categories = products.reduce((acc, product) => {
                        acc[product.category] = (acc[product.category] || 0) + 1;
                        return acc;
                    }, {});

                    new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: Object.keys(categories),
                            datasets: [{
                                data: Object.values(categories),
                                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false
                        }
                    });
                }
            }, [products]);

            return (
                <div className="fade-in">
                    <div className="page-header">
                        <h1 className="page-title">Dashboard</h1>
                    </div>

                    <div className="stats-grid">
                        <div className="stat-card">
                            <div className="stat-info">
                                <h3>{stats.totalProducts}</h3>
                                <p>Total Productos</p>
                            </div>
                            <div className="stat-icon stat-products">üì¶</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-info">
                                <h3>{formatCurrency(stats.totalValue)}</h3>
                                <p>Valor Inventario</p>
                            </div>
                            <div className="stat-icon stat-value">üí∞</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-info">
                                <h3>{stats.lowStock}</h3>
                                <p>Stock Bajo</p>
                            </div>
                            <div className="stat-icon stat-low">‚ö†Ô∏è</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-info">
                                <h3>{stats.totalUsers}</h3>
                                <p>Usuarios Activos</p>
                            </div>
                            <div className="stat-icon stat-users">üë•</div>
                        </div>
                    </div>

                    <div className="charts-grid">
                        <div className="chart-card">
                            <h3>Tendencia de Ventas</h3>
                            <div style={{height: '300px'}}>
                                <canvas ref={chartRef}></canvas>
                            </div>
                        </div>
                        <div className="chart-card">
                            <h3>Productos por Categor√≠a</h3>
                            <div style={{height: '300px'}}>
                                <canvas ref={pieChartRef}></canvas>
                            </div>
                        </div>
                    </div>

                    <div className="products-table">
                        <div className="table-header">
                            <h3>Productos con Stock Bajo</h3>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Producto</th>
                                    <th>SKU</th>
                                    <th>Stock</th>
                                    <th>Estado</th>
                                </tr>
                            </thead>
                            <tbody>
                                {products.filter(p => p.quantity <= p.minStock).map(product => (
                                    <tr key={product.id}>
                                        <td>{product.name}</td>
                                        <td>{product.sku}</td>
                                        <td>{product.quantity}</td>
                                        <td>
                                            <span className={`status-badge ${product.quantity === 0 ? 'status-out' : 'status-low'}`}>
                                                {product.quantity === 0 ? 'Agotado' : 'Stock Bajo'}
                                            </span>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        // Componente Products
        function Products({ products, setProducts, user }) {
            const [showModal, setShowModal] = useState(false);
            const [editingProduct, setEditingProduct] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [formData, setFormData] = useState({
                name: '', sku: '', category: 'Tecnolog√≠a', quantity: '', minStock: '', price: ''
            });

            const categories = ['Tecnolog√≠a', 'Hogar', 'Ropa', 'Alimentos'];
            const canEdit = user.role === 'admin' || user.role === 'manager';

            const filteredProducts = products.filter(product =>
                product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                product.sku.toLowerCase().includes(searchTerm.toLowerCase())
            );

            const formatCurrency = (value) => {
                return new Intl.NumberFormat('es-CL', {
                    style: 'currency',
                    currency: 'CLP',
                    minimumFractionDigits: 0
                }).format(value);
            };

            const handleOpenModal = (product = null) => {
                if (product) {
                    setEditingProduct(product);
                    setFormData({
                        name: product.name,
                        sku: product.sku,
                        category: product.category,
                        quantity: product.quantity.toString(),
                        minStock: product.minStock.toString(),
                        price: product.price.toString()
                    });
                } else {
                    setEditingProduct(null);
                    setFormData({
                        name: '', sku: '', category: 'Tecnolog√≠a', quantity: '', minStock: '', price: ''
                    });
                }
                setShowModal(true);
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!formData.name || !formData.price) {
                    alert('Por favor completa todos los campos obligatorios');
                    return;
                }

                const productData = {
                    ...formData,
                    quantity: parseInt(formData.quantity) || 0,
                    minStock: parseInt(formData.minStock) || 5,
                    price: parseFloat(formData.price) || 0,
                    status: 'active'
                };

                if (editingProduct) {
                    setProducts(products.map(p => 
                        p.id === editingProduct.id 
                            ? { ...productData, id: editingProduct.id }
                            : p
                    ));
                } else {
                    const newProduct = {
                        ...productData,
                        id: Date.now()
                    };
                    setProducts([...products, newProduct]);
                }

                setShowModal(false);
                setEditingProduct(null);
            };

            const handleDelete = (productId) => {
                if (confirm('¬øEst√°s seguro de eliminar este producto?')) {
                    setProducts(products.filter(p => p.id !== productId));
                }
            };

            const getStockStatus = (quantity, minStock) => {
                if (quantity === 0) return { label: 'Agotado', class: 'status-out' };
                if (quantity <= minStock) return { label: 'Stock Bajo', class: 'status-low' };
                return { label: 'Disponible', class: 'status-active' };
            };

            return (
                <div className="fade-in">
                    <div className="page-header">
                        <h1 className="page-title">Gesti√≥n de Productos</h1>
                        {canEdit && (
                            <button className="add-btn" onClick={() => handleOpenModal()}>
                                ‚ûï Nuevo Producto
                            </button>
                        )}
                    </div>

                    <div className="products-table">
                        <div className="table-header">
                            <h3>Lista de Productos</h3>
                            <input
                                type="text"
                                placeholder="üîç Buscar productos..."
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                                style={{
                                    padding: '8px 12px',
                                    border: '1px solid #ddd',
                                    borderRadius: '6px',
                                    width: '250px'
                                }}
                            />
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Producto</th>
                                    <th>SKU</th>
                                    <th>Categor√≠a</th>
                                    <th>Stock</th>
                                    <th>Precio</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                {filteredProducts.map(product => {
                                    const stockStatus = getStockStatus(product.quantity, product.minStock);
                                    return (
                                        <tr key={product.id}>
                                            <td>
                                                <strong>{product.name}</strong>
                                            </td>
                                            <td>{product.sku}</td>
                                            <td>{product.category}</td>
                                            <td>{product.quantity}</td>
                                            <td>{formatCurrency(product.price)}</td>
                                            <td>
                                                <span className={`status-badge ${stockStatus.class}`}>
                                                    {stockStatus.label}
                                                </span>
                                            </td>
                                            <td>
                                                <button className="action-btn">üëÅÔ∏è</button>
                                                {canEdit && (
                                                    <>
                                                        <button 
                                                            className="action-btn"
                                                            onClick={() => handleOpenModal(product)}
                                                        >
                                                            ‚úèÔ∏è
                                                        </button>
                                                        {user.role === 'admin' && (
                                                            <button 
                                                                className="action-btn"
                                                                onClick={() => handleDelete(product.id)}
                                                            >
                                                                üóëÔ∏è
                                                            </button>
                                                        )}
                                                    </>
                                                )}
                                            </td>
                                        </tr>
                                    );
                                })}
                            </tbody>
                        </table>
                    </div>

                    {/* Modal */}
                    {showModal && (
                        <div className="modal-overlay">
                            <div className="modal">
                                <h2>{editingProduct ? 'Editar Producto' : 'Nuevo Producto'}</h2>
                                <form onSubmit={handleSubmit}>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>Nombre del Producto *</label>
                                            <input
                                                type="text"
                                                value={formData.name}
                                                onChange={(e) => setFormData({...formData, name: e.target.value})}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>SKU</label>
                                            <input
                                                type="text"
                                                value={formData.sku}
                                                onChange={(e) => setFormData({...formData, sku: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>Categor√≠a</label>
                                            <select
                                                value={formData.category}
                                                onChange={(e) => setFormData({...formData, category: e.target.value})}
                                            >
                                                {categories.map(cat => (
                                                    <option key={cat} value={cat}>{cat}</option>
                                                ))}
                                            </select>
                                        </div>
                                        <div className="form-group">
                                            <label>Precio (CLP) *</label>
                                            <input
                                                type="number"
                                                value={formData.price}
                                                onChange={(e) => setFormData({...formData, price: e.target.value})}
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label>Cantidad</label>
                                            <input
                                                type="number"
                                                value={formData.quantity}
                                                onChange={(e) => setFormData({...formData, quantity: e.target.value})}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label>Stock M√≠nimo</label>
                                            <input
                                                type="number"
                                                value={formData.minStock}
                                                onChange={(e) => setFormData({...formData, minStock: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    <div className="form-actions">
                                        <button type="submit" className="btn">
                                            {editingProduct ? 'Actualizar' : 'Crear'}
                                        </button>
                                        <button 
                                            type="button" 
                                            className="btn-secondary"
                                            onClick={() => setShowModal(false)}
                                        >
                                            Cancelar
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Componente Reports
        function Reports({ products }) {
            const stats = {
                totalProducts: products.length,
                totalValue: products.reduce((sum, p) => sum + (p.quantity * p.price), 0),
                lowStock: products.filter(p => p.quantity <= p.minStock).length,
                averagePrice: products.reduce((sum, p) => sum + p.price, 0) / products.length
            };

            const categoryStats = products.reduce((acc, product) => {
                if (!acc[product.category]) {
                    acc[product.category] = { count: 0, value: 0 };
                }
                acc[product.category].count += 1;
                acc[product.category].value += product.quantity * product.price;
                return acc;
            }, {});

            const formatCurrency = (value) => {
                return new Intl.NumberFormat('es-CL', {
                    style: 'currency',
                    currency: 'CLP',
                    minimumFractionDigits: 0
                }).format(value);
            };

            return (
                <div className="fade-in">
                    <div className="page-header">
                        <h1 className="page-title">Reportes y An√°lisis</h1>
                    </div>

                    <div className="stats-grid">
                        <div className="stat-card">
                            <div className="stat-info">
                                <h3>{stats.totalProducts}</h3>
                                <p>Total Productos</p>
                            </div>
                            <div className="stat-icon stat-products">üìä</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-info">
                                <h3>{formatCurrency(stats.totalValue)}</h3>
                                <p>Valor Total</p>
                            </div>
                            <div className="stat-icon stat-value">üí∞</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-info">
                                <h3>{stats.lowStock}</h3>
                                <p>Productos Cr√≠ticos</p>
                            </div>
                            <div className="stat-icon stat-low">‚ö†Ô∏è</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-info">
                                <h3>{formatCurrency(stats.averagePrice)}</h3>
                                <p>Precio Promedio</p>
                            </div>
                            <div className="stat-icon stat-users">üìà</div>
                        </div>
                    </div>

                    <div className="products-table">
                        <div className="table-header">
                            <h3>An√°lisis por Categor√≠a</h3>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Categor√≠a</th>
                                    <th>Cantidad de Productos</th>
                                    <th>Valor Total</th>
                                    <th>Porcentaje</th>
                                </tr>
                            </thead>
                            <tbody>
                                {Object.entries(categoryStats).map(([category, data]) => (
                                    <tr key={category}>
                                        <td><strong>{category}</strong></td>
                                        <td>{data.count}</td>
                                        <td>{formatCurrency(data.value)}</td>
                                        <td>{((data.count / stats.totalProducts) * 100).toFixed(1)}%</td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>

                    <div className="products-table">
                        <div className="table-header">
                            <h3>Productos M√°s Valiosos</h3>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Producto</th>
                                    <th>Precio Unitario</th>
                                    <th>Stock</th>
                                    <th>Valor Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                {products
                                    .sort((a, b) => (b.quantity * b.price) - (a.quantity * a.price))
                                    .slice(0, 5)
                                    .map(product => (
                                        <tr key={product.id}>
                                            <td><strong>{product.name}</strong></td>
                                            <td>{formatCurrency(product.price)}</td>
                                            <td>{product.quantity}</td>
                                            <td>{formatCurrency(product.quantity * product.price)}</td>
                                        </tr>
                                    ))
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        // Renderizar la aplicaci√≥n (compatible con React 18)
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
